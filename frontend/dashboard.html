<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="SpinningLab - Professional cycling performance analytics dashboard">
  <title>Dashboard - SpinningLab</title>
  
  <!-- Preconnect to improve performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- Inter Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <!-- Display Font for headings -->
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@600;700;800&display=swap" rel="stylesheet">
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
  
  <!-- SINGLE CSS IMPORT - main.css imports everything else in correct order -->
  <link rel="stylesheet" href="/static/css/main.css">
  
  <!-- Feather Icons -->
  <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>

  <!-- Strava OAuth code handler: move ?code into hash so SPA can process it -->
  <script>
    (function() {
      try {
        const search = window.location.search;
        if (search && search.includes('code=')) {
          const query = search.startsWith('?') ? search.slice(1) : search;
          const targetHash = window.location.hash.split('?')[0] || '#/settings';
          const newUrl = `${window.location.pathname}${targetHash}?${query}`;
          window.history.replaceState({}, document.title, newUrl);
        }
      } catch (e) {
        console.warn('Strava code handler failed:', e);
      }
    })();
  </script>
  
  <style>
    /* CRITICAL: Ensure Feather icons are always visible */
    .sidebar i[data-feather],
    .nav-item i[data-feather],
    .sidebar-brand i[data-feather],
    .user-avatar i[data-feather],
    .logout-btn i[data-feather] {
      display: inline-flex !important;
      width: 20px;
      height: 20px;
      stroke: currentColor;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
      fill: none;
    }

    /* Make SVG icons visible */
    .sidebar svg,
    .nav-item svg {
      display: block !important;
      pointer-events: none;
    }

    /* Brand logo styling */
    .brand-logo {
      flex-shrink: 0;
    }

    .sidebar-spinning-wheel {
      animation: sidebar-spin 20s linear infinite;
    }

    .sidebar-orbiting-icons {
      animation: sidebar-orbit 40s linear infinite;
    }

    @keyframes sidebar-spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @keyframes sidebar-orbit {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(-360deg); }
    }

    /* Ensure logout button is clickable */
    .logout-btn {
      cursor: pointer;
      pointer-events: all !important;
    }
  </style>

</head>
<body>
  <div id="dashboard-root"></div>

  <!-- ========== JAVASCRIPT MODULES ========== -->
  <!-- Vite Entry Point - Loads all modules optimized -->
  <script type="module" src="/src/dashboard-main.js"></script>

</body>
</html>
