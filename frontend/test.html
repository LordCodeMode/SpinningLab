<!doctype html>
<html lang="en" data-bs-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light">
  <title>Training Pro · Dashboard</title>

  <!-- Tabler CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta20/dist/css/tabler.min.css">
  <!-- Tabler Icons -->
  <script defer src="https://cdn.jsdelivr.net/npm/@tabler/icons@2.47.0/dist/tabler-icons.min.js"></script>
  <!-- Chart.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>

  <style>
    :root{
      --card-border: #e9edf5;
      --muted: #6b7280;
      --bg: #f7f8fb;
      --accent: #1f6feb;
    }
    body{ background: var(--bg); }

    /* Topbar */
    .navbar{ border-bottom:1px solid var(--card-border); }

    /* KPI cards: minimal, ruhig */
    .kpi .card{ border:1px solid var(--card-border); box-shadow:none; }
    .kpi .label{
      color: var(--muted); font-size:.72rem; text-transform:uppercase; letter-spacing:.08em;
    }
    .kpi .value{
      font-weight:800; letter-spacing:-0.01em;
      font-size: clamp(28px, 3vw, 36px);
    }

    /* Chart card */
    .card-chart{ border:1px solid var(--card-border); }
    .chart-wrapper{ height: 380px; }
    @media (max-width: 768px){ .chart-wrapper{ height: 300px; } }

    /* Segmented range buttons */
    .range-group .btn{ border-color:#dbe2ef; }
    .range-group .btn.active{ background:var(--accent); color:#fff; border-color:var(--accent); }

    /* Table */
    .table th, .table td{ vertical-align: middle; }
    .muted{ color:#95a1b2; }

    /* Focus */
    .btn:focus-visible, .form-check-input:focus-visible{
      outline:2px solid rgba(31,111,235,.35); outline-offset:2px;
    }
  </style>
</head>
<body>

  <!-- Topbar -->
  <header class="navbar navbar-expand-md sticky-top bg-white">
    <div class="container-xl">
      <a class="navbar-brand" href="#" aria-label="Training Pro">
        <span class="navbar-brand-text fw-bold">Training&nbsp;Pro</span>
      </a>

      <div class="ms-auto d-flex align-items-center gap-2">
        <button id="refresh-btn" class="btn btn-outline" aria-label="Refresh">
          <i class="ti ti-refresh me-1" aria-hidden="true"></i>Refresh
        </button>

        <div class="nav-item dropdown">
          <a href="#" class="nav-link d-flex lh-1" data-bs-toggle="dropdown" aria-label="Open user menu">
            <span class="avatar bg-primary-lt text-primary fw-bold">M</span>
          </a>
          <div class="dropdown-menu dropdown-menu-end">
            <a class="dropdown-item" href="#">Settings</a>
            <a class="dropdown-item" href="#">Logout</a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main -->
  <div class="page">
    <div class="container-xl">

      <!-- Title + Range -->
      <div class="d-flex align-items-center justify-content-between mt-4 mb-2">
        <h1 class="page-title m-0">Dashboard</h1>
        <div class="btn-group range-group" role="group" aria-label="Range selector">
          <button class="btn btn-outline btn-sm active" data-range="30" type="button">Last 30d</button>
          <button class="btn btn-outline btn-sm" data-range="90"  type="button">90d</button>
          <button class="btn btn-outline btn-sm" data-range="180" type="button">180d</button>
          <button class="btn btn-outline btn-sm" data-range="ytd" type="button">YTD</button>
        </div>
      </div>

      <!-- KPIs -->
      <div class="row row-cards kpi">
        <div class="col-sm-6 col-lg-3">
          <div class="card"><div class="card-body">
            <div class="label mb-1">Fitness (CTL)</div>
            <div id="kpi-ctl" class="value">–</div>
          </div></div>
        </div>
        <div class="col-sm-6 col-lg-3">
          <div class="card"><div class="card-body">
            <div class="label mb-1">Fatigue (ATL)</div>
            <div id="kpi-atl" class="value">–</div>
          </div></div>
        </div>
        <div class="col-sm-6 col-lg-3">
          <div class="card"><div class="card-body">
            <div class="label mb-1">Form (TSB)</div>
            <div id="kpi-tsb" class="value">–</div>
          </div></div>
        </div>
        <div class="col-sm-6 col-lg-3">
          <div class="card"><div class="card-body">
            <div class="label mb-1">Distance (7d)</div>
            <div id="kpi-distance" class="value">– km</div>
          </div></div>
        </div>
      </div>

      <!-- Training load -->
      <div class="row row-cards mt-2">
        <div class="col-12">
          <div class="card card-chart">
            <div class="card-header align-items-center">
              <h3 class="card-title">Training Load Trend</h3>
              <div class="ms-auto d-flex align-items-center gap-3">
                <label class="form-check form-switch m-0" aria-label="Toggle smoothing">
                  <input class="form-check-input" type="checkbox" id="toggle-smoothing">
                  <span class="form-check-label">Smoothing</span>
                </label>
              </div>
            </div>
            <div class="card-body">
              <div class="chart-wrapper">
                <canvas id="chart-load" aria-label="Training load chart" role="img"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Zones + Recent -->
      <div class="row row-cards mt-1">
        <div class="col-lg-4">
          <div class="card h-100">
            <div class="card-header">
              <h3 class="card-title">Zone Distribution</h3>
            </div>
            <div class="card-body">
              <div style="height:260px">
                <canvas id="chart-zones" aria-label="Power zone distribution" role="img"></canvas>
              </div>
              <div class="mt-2 small text-secondary">Based on recent activities</div>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          <div class="card h-100">
            <div class="card-header">
              <h3 class="card-title">Recent Activities</h3>
            </div>
            <div class="card-body p-0">
              <div class="table-responsive">
                <table class="table table-vcenter card-table">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Title</th>
                      <th class="text-end">Duration</th>
                      <th class="text-end">Distance</th>
                      <th class="text-end">NP</th>
                      <th class="text-end">TSS</th>
                      <th class="text-end">IF</th>
                    </tr>
                  </thead>
                  <tbody id="tbl-activities"></tbody>
                </table>
              </div>
              <div class="px-3 pb-3 small muted">Showing last 5 activities</div>
            </div>
          </div>
        </div>
      </div>

      <footer class="my-4 small text-secondary">
        Built with Tabler · Demo layout for Training Pro
      </footer>

    </div>
  </div>

  <!-- Tabler JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta20/dist/js/tabler.min.js"></script>

  <script>
    // ---------- Demo Data ----------
    const days = 60;
    const labels = Array.from({length: days}, (_, i) => {
      const d = new Date(); d.setDate(d.getDate() - (days - 1 - i));
      return d.toLocaleDateString(undefined, { month:'short', day:'numeric' });
    });

    const ctl = labels.map((_, i) => 46 + i*0.28 + 6*Math.sin(i/4));
    const atl = labels.map((_, i) => 40 + 8*Math.sin(i/2.7));
    const tsb = ctl.map((v, i) => v - atl[i]);

    const recent = [
      { date:'2025-09-16', title:'Endurance Ride', dur:'1h 53m', dist:'51.0 km', np:'223 W', tss:150, ifv:'0.89' },
      { date:'2025-09-14', title:'VO₂ Session',    dur:'1h 10m', dist:'32.4 km', np:'268 W', tss:120, ifv:'0.95' },
      { date:'2025-09-12', title:'Tempo',          dur:'1h 20m', dist:'40.8 km', np:'241 W', tss:105, ifv:'0.90' },
      { date:'2025-09-10', title:'Recovery',       dur:'0h 55m', dist:'22.0 km', np:'170 W', tss:35,  ifv:'0.60' },
      { date:'2025-09-08', title:'Sweetspot',      dur:'1h 35m', dist:'48.7 km', np:'255 W', tss:130, ifv:'0.93' },
    ];

    // ---------- Populate KPI & Table ----------
    const $ = (sel) => document.querySelector(sel);

    $('#kpi-ctl').textContent = Math.round(ctl.at(-1));
    $('#kpi-atl').textContent = Math.round(atl.at(-1));
    $('#kpi-tsb').textContent = Math.round(tsb.at(-1));
    $('#kpi-distance').textContent = '188.5 km';

    const tbody = $('#tbl-activities');
    tbody.innerHTML = recent.map(r => `
      <tr>
        <td>${new Date(r.date).toLocaleDateString()}</td>
        <td>${r.title}</td>
        <td class="text-end">${r.dur}</td>
        <td class="text-end">${r.dist}</td>
        <td class="text-end">${r.np}</td>
        <td class="text-end">${r.tss}</td>
        <td class="text-end">${r.ifv}</td>
      </tr>
    `).join('');

    // ---------- Charts ----------
    function buildLoadChart(){
      const ctx = document.getElementById('chart-load');
      return new Chart(ctx, {
        type: 'line',
        data: {
          labels,
          datasets: [
            { label:'CTL (Fitness)', data: ctl, borderColor:'#1f6feb', backgroundColor:'rgba(31,111,235,.10)', tension:.35, fill:true },
            { label:'ATL (Fatigue)', data: atl, borderColor:'#7c3aed', backgroundColor:'rgba(124,58,237,.10)', tension:.35, fill:true },
            { label:'TSB (Form)',    data: tsb, borderColor:'#15803d', backgroundColor:'rgba(21,128,61,.08)', tension:.35, fill:true }
          ]
        },
        options: {
          responsive:true, maintainAspectRatio:false,
          plugins:{ legend:{ position:'bottom' }, tooltip:{ mode:'index', intersect:false } },
          scales:{ x:{ grid:{ display:false } }, y:{ grid:{ color:'rgba(0,0,0,.05)' } } }
        }
      });
    }

    function buildZonesChart(){
      const z = document.getElementById('chart-zones');
      return new Chart(z, {
        type: 'doughnut',
        data: {
          labels:['Z1','Z2','Z3','Z4','Z5','Z6','Z7'],
          datasets:[{
            data:[18,28,22,16,10,4,2],
            borderWidth:2, borderColor:'#fff',
            backgroundColor:['#e5e7eb','#60a5fa','#34d399','#fbbf24','#f87171','#a78bfa','#f472b6']
          }]
        },
        options:{ plugins:{ legend:{ position:'right' } }, cutout:'60%' }
      });
    }

    let loadChart = null, zoneChart = null;
    window.addEventListener('DOMContentLoaded', () => {
      loadChart = buildLoadChart();
      zoneChart = buildZonesChart();
    });

    // ---------- UI interactions (demo) ----------
    document.querySelectorAll('.range-group .btn').forEach(btn=>{
      btn.addEventListener('click', (e)=>{
        document.querySelectorAll('.range-group .btn').forEach(b=>b.classList.remove('active'));
        e.currentTarget.classList.add('active');
        // Hier würdest du echte Daten nachladen und Charts/KPIs updaten
      });
    });

    document.getElementById('toggle-smoothing').addEventListener('change', (e)=>{
      const t = e.target.checked ? .5 : .35;
      loadChart.data.datasets.forEach(ds => ds.tension = t);
      loadChart.update('none');
    });

    document.getElementById('refresh-btn').addEventListener('click', ()=>{
      // Demo: kleiner Pulse-Effekt
      loadChart.update('active');
    });
  </script>
</body>
</html>